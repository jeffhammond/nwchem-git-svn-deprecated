      integer azone1,azone2,azone3,azone4
      integer g1b,g2b,g3b,g4b
      integer key_agaa_off,key_ggaa_off
      key_agaa_off(azone1,azone2,azone3,g3b,noa,nva,atpart) =
     =     g3b - 1 + (noa+nva) * (azone3 - 1 +
     &  (atpart) * (azone1 - 1 + atpart * (azone2 - 1)))
      key_ggaa_off(azone1,azone2,g3b,g4b,noa,nva,atpart) =
     =     azone1 - 1 + atpart * (g4b - 1 +
     &  (noa+nva) * (g3b - 1 + (noa+nva) * (azone2 - 1)))

